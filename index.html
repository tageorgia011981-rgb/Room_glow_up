<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Glow Up</title>
    <link href="https://fonts.googleapis.com/css2?family=Limelight&display=swap" rel="stylesheet">
    <style>
        :root {
            --metal-shine: linear-gradient(145deg, #bdc3c7, #2c3e50, #95a5a6, #000);
            --glow-teal: #00f2ff;
        }
        body, html {
            margin: 0; padding: 0; min-height: 100vh;
            background: url('Assets/mainbackground.jpg') no-repeat center center fixed;
            background-size: cover; overflow: hidden;
        }

        /* --- DECOR CLOSET SYSTEM --- */
        #closet-entrance { 
            position: fixed; right: -600px; top: 120px; width: 550px; height: 700px; 
            z-index: 400; transition: right 1.5s cubic-bezier(0.23, 1, 0.32, 1); 
            perspective: 2000px; 
        }
        #closet-entrance.active { right: 40px; }
        
        .closet-interior { 
            position: absolute; width: 100%; height: 100%; 
            background: url('Assets/decorclosetbackground.jpg') no-repeat center;
            background-size: cover; border: 4px solid #222; z-index: 1;
        }

        .door-wing { position: absolute; width: 50%; height: 100%; transition: 1.5s; z-index: 5; overflow: hidden; cursor: pointer; }
        .wing-l { left: 0; transform-origin: left; } .wing-r { right: 0; transform-origin: right; }
        .door-wing img { width: 200%; height: 100%; object-fit: cover; pointer-events: none; }
        .wing-r img { object-position: right; } .wing-l img { object-position: left; }
        
        #closet-entrance.open .wing-l { transform: rotateY(-135deg); }
        #closet-entrance.open .wing-r { transform: rotateY(135deg); }

        /* --- RUG ITEM BOXES --- */
        .rug-box {
            position: absolute; width: 80px; height: 180px; /* Hanging look */
            cursor: grab; z-index: 10; transition: transform 0.4s ease, width 0.4s ease, height 0.4s ease;
            display: flex; justify-content: center; align-items: center;
        }
        .rug-box img { width: 100%; height: 100%; pointer-events: none; object-fit: cover; box-shadow: 5px 5px 15px rgba(0,0,0,0.5); }

        /* Class added when rug leaves the closet area */
        .rug-flat {
            width: 300px !important; height: 150px !important;
            transform: rotateX(60deg) rotateZ(0deg) !important; /* Lays it flat in perspective */
        }

        #theater-stage {
            position: absolute; left: 50px; top: 150px;
            width: 900px; height: 600px; border: 10px solid #000;
            background: rgba(0,0,0,0.2); pointer-events: none;
        }
    </style>
</head>
<body>

    <nav style="display: flex; justify-content: center; margin-top: 20px;">
        <button onclick="document.getElementById('closet-entrance').classList.toggle('active')" style="padding: 15px 30px; font-family: 'Limelight'; cursor: pointer;">DECOR CLOSET</button>
    </nav>

    <div id="theater-stage"></div>

    <div id="closet-entrance">
        <div class="door-wing wing-l" onclick="this.parentElement.classList.toggle('open')"><img src="Assets/closetdoors.jpg"></div>
        <div class="door-wing wing-r" onclick="this.parentElement.classList.toggle('open')"><img src="Assets/closetdoors.jpg"></div>
        
        <div id="closet-view" class="closet-interior">
            <div class="rug-box" data-ox="60" data-oy="100" style="top: 100px; left: 60px;" ondblclick="returnRug(this)">
                <img src="Assets/rug1.png">
            </div>
            <div class="rug-box" data-ox="200" data-oy="100" style="top: 100px; left: 200px;" ondblclick="returnRug(this)">
                <img src="Assets/rug2.png">
            </div>
        </div>
    </div>

<script>
    let activeRug = null;
    let offset = { x: 0, y: 0 };

    document.addEventListener('mousedown', (e) => {
        const target = e.target.closest('.rug-box');
        if (target) {
            activeRug = target;
            const rect = activeRug.getBoundingClientRect();
            offset.x = e.clientX - rect.left;
            offset.y = e.clientY - rect.top;
            activeRug.style.zIndex = 1000;
        }
    });

    document.addEventListener('mousemove', (e) => {
        if (activeRug) {
            const closetRect = document.getElementById('closet-view').getBoundingClientRect();
            const x = e.clientX - closetRect.left - offset.x;
            const y = e.clientY - closetRect.top - offset.y;
            
            activeRug.style.left = x + 'px';
            activeRug.style.top = y + 'px';

            // Logic to flatten rug if dragged left out of the closet
            if (x < -50) {
                activeRug.classList.add('rug-flat');
            } else {
                activeRug.classList.remove('rug-flat');
            }
        }
    });

    document.addEventListener('mouseup', () => { activeRug = null; });

    function returnRug(el) {
        el.classList.remove('rug-flat');
        el.style.left = el.getAttribute('data-ox') + 'px';
        el.style.top = el.getAttribute('data-oy') + 'px';
    }
</script>
</body>
</html>
