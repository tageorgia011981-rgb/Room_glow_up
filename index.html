<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Room Glow Up | Decor Fan Fixed</title>
<link href="https://fonts.googleapis.com/css2?family=Limelight&family=Special+Elite&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  background: #0f1011 url("background_color.jpg") center / cover fixed;
  min-height: 100vh; font-family: 'Special Elite', cursive; color: #fff;
  overflow-y: auto; overflow-x: hidden;
}

/* Header */
.site-header { text-align: center; padding: 50px 0 20px; z-index: 2000; position: relative; }
.brand-title {
  font-family: 'Limelight', cursive; font-size: 95px; text-transform: uppercase;
  background: linear-gradient(to bottom, #ffffff 0%, #8e9196 50%, #2c2e30 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  letter-spacing: 6px; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.8));
}
.sub-title { font-family: 'Limelight', cursive; font-size: 20px; letter-spacing: 10px; color: #fff; opacity: 0.9; margin-top: 15px; text-transform: uppercase; }

/* Tabs */
.vintage-tabs { display: flex; justify-content: center; gap: 20px; padding: 30px 0; z-index: 2000; position: relative; }
.drawer-hardware {
  position: relative; width: 220px; height: 90px;
  background: linear-gradient(135deg, #2c2e30 0%, #000 100%);
  border: 3px solid #1a1a1a;
  box-shadow: inset 0 0 15px rgba(255,255,255,0.05), 0 10px 20px rgba(0,0,0,0.8);
  display: flex; align-items: center; justify-content: center; cursor: pointer;
  transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
.drawer-hardware:hover .plate-style { box-shadow: 0 0 20px rgba(255,255,255,0.4); border-color: #fff; }
.active-lift { transform: translateY(15px) !important; border-color: #8e9196; }
.plate-style {
  width: 170px; height: 45px;
  background: linear-gradient(145deg, #e0e0e0 0%, #8e9196 45%, #ffffff 50%, #8e9196 55%, #444 100%);
  color: #000; display: flex; align-items: center; justify-content: center;
  font-size: 14px; font-weight: bold; text-transform: uppercase;
  border: 2px solid #333; pointer-events: none; transition: 0.3s;
}
.lip-pull { position: absolute; bottom: -7px; left: 50%; transform: translateX(-50%); width: 110px; height: 16px; background: linear-gradient(#333, #111, #000); border-radius: 0 0 10px 10px; border: 1px solid #111; }

/* Workspace */
.workspace { display: flex; justify-content: flex-start; align-items: flex-start; min-height: 1200px; padding: 40px 60px; position: relative; }
.cabinet-container { position: absolute; left: -600px; top: 0; width: 480px; z-index: 1000; transition: left 0.8s cubic-bezier(0.19, 1, 0.22, 1); }
.cabinet-visible { left: 40px !important; }
.cabinet-image { width: 100%; filter: drop-shadow(20px 0 60px #000); }
.drawer-stack { position: absolute; top: 120px; left: 50%; transform: translateX(-50%); width: 100%; display: flex; flex-direction: column; align-items: center; gap: 45px; }

/* Stage */
.stage { width: 950px; height: 580px; background: #050505; border: 15px solid #2c2e30; box-shadow: 0 0 120px black; margin-left: 520px; margin-top: 40px; z-index: 500; position: relative; }
#room-display { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; display: none; transition: opacity 0.3s ease; }

/* Fan */
.fan-system { position: absolute; left: 360px; z-index: 1100; pointer-events: none; transition: top 0.4s cubic-bezier(0.19, 1, 0.22, 1); }
.swatch-blade {
  position: absolute; left: 0; width: 0; height: 65px;
  background: linear-gradient(to right, #444, #8e9196, #1a1a1a);
  border: 1px solid #000; border-radius: 0 35px 35px 0;
  transform-origin: left center; transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
  opacity: 0; display: flex; align-items: center; justify-content: center;
  box-shadow: 8px 4px 15px rgba(0,0,0,0.6); overflow: hidden;
}
.blade-label {
  font-family: 'Special Elite', cursive; color: #111; font-size: 14px;
  text-transform: uppercase; width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center;
  letter-spacing: 2px; font-weight: bold; pointer-events: auto; cursor: pointer;
  padding: 0 15px; text-align: center;
}
.pivot-bolt {
  position: absolute; left: -14px; top: -14px; width: 28px; height: 28px;
  background: radial-gradient(circle at 30% 30%, #4a4d4f, #2a2d2f, #000);
  border: 2px solid #111; border-radius: 4px; z-index: 1200; opacity: 0; transition: 0.3s;
}

/* Blade rotations */
.s-1 { transform: rotate(-50deg); } .s-2 { transform: rotate(-25deg); } .s-3 { transform: rotate(0deg); } .s-4 { transform: rotate(25deg); } .s-5 { transform: rotate(50deg); }

/* Fan icon */
.fan-icon { width: 50px; height: 50px; cursor: pointer; transition: 0.2s; margin-left: 10px; }

/* Inspiration overlay */
#insp-overlay { position: fixed; inset: 0; background: rgba(10, 11, 12, 0.98); z-index: 3000; display: none; overflow-y: auto; padding: 60px; border: 15px solid #2c2e30; box-shadow: inset 0 0 100px #000; }
.close-overlay { position: absolute; top: 20px; right: 40px; font-size: 60px; cursor: pointer; color: #8e9196; z-index: 3100; }
.insp-masonry { column-count: 3; column-gap: 20px; width: 100%; max-width: 1200px; margin: 40px auto; }
.insp-item { break-inside: avoid; margin-bottom: 20px; background: #1a1a1a; border: 2px solid #333; transition: 0.3s; }
.insp-item img { width: 100%; display: block; filter: grayscale(20%); transition: 0.3s; }
.insp-item:hover { border-color: #8e9196; transform: translateY(-5px); }
.insp-item:hover img { filter: grayscale(0%); }

.placed-item { position: absolute; width: 220px; cursor: move; filter: drop-shadow(0 15px 30px black); z-index: 1500; }
</style>
</head>
<body>

<header class="site-header">
  <h1 class="brand-title">Room Glow Up</h1>
  <div class="sub-title">Your Dream Space Come To Life</div>
</header>

<nav class="vintage-tabs">
  <div class="drawer-hardware" onclick="lift(this); openCabinet('rooms')"><div class="plate-style">Rooms</div><div class="lip-pull"></div></div>
  <div class="drawer-hardware" onclick="lift(this); openCabinet('furniture')"><div class="plate-style">Furniture</div><div class="lip-pull"></div></div>
  <div class="drawer-hardware" onclick="lift(this); openCabinet('decor')"><div class="plate-style">Decor</div><div class="lip-pull"></div></div>
  <div class="drawer-hardware" onclick="lift(this); openInspiration()"><div class="plate-style">Inspiration</div><div class="lip-pull"></div></div>
  <div class="drawer-hardware" onclick="lift(this)"><div class="plate-style">Save</div><div class="lip-pull"></div></div>
</nav>

<div class="workspace">
  <div class="cabinet-container" id="cab-container">
    <img src="cabinet.png" class="cabinet-image">
    <div class="drawer-stack" id="drawer-anchor">
      <div class="drawer-row" onmouseover="previewRoom('livingroom.jpg')" onmouseout="resetRoom()" onclick="handleDrawerClick('livingroom.jpg', this)">
        <div class="drawer-hardware"><div class="plate-style">Living Room</div><div class="lip-pull"></div></div>
      </div>
      <div class="drawer-row" onmouseover="previewRoom('bedroom.jpg')" onmouseout="resetRoom()" onclick="handleDrawerClick('bedroom.jpg', this)">
        <div class="drawer-hardware"><div class="plate-style">Bedroom</div><div class="lip-pull"></div></div>
      </div>
      <div class="drawer-row" onmouseover="previewRoom('diningroom.jpg')" onmouseout="resetRoom()" onclick="handleDrawerClick('diningroom.jpg', this)">
        <div class="drawer-hardware"><div class="plate-style">Dining Room</div><div class="lip-pull"></div></div>
      </div>
      <div class="drawer-row" onclick="handleDrawerClick('custom', this)">
        <div class="drawer-hardware" style="background:#1a1a1a;"><div class="plate-style" style="background:#2a2d2f; color:#fff;">Upload / Load</div><div class="lip-pull"></div></div>
      </div>
    </div>

    <div id="fan-engine" class="fan-system">
      <div class="pivot-bolt"></div>
      <div class="swatch-blade s-1" id="b1"></div>
      <div class="swatch-blade s-2" id="b2"></div>
      <div class="swatch-blade s-3" id="b3"></div>
      <div class="swatch-blade s-4" id="b4"></div>
      <div class="swatch-blade s-5" id="b5"></div>
    </div>
  </div>

  <div class="stage" id="stage-zone" ondragover="event.preventDefault()" ondrop="drop(event)"><img id="room-display"></div>
</div>

<script>
const roomImg = document.getElementById('room-display');
const cab = document.getElementById('cab-container');
const fan = document.getElementById('fan-engine');
const b = [document.getElementById('b1'), document.getElementById('b2'), document.getElementById('b3'), document.getElementById('b4'), document.getElementById('b5')];
let currentLevel = 0; let activeRoom = ''; let activeEl = null; let activeMode = 'rooms'; let lockedRoom = '';

function openInspiration() { document.getElementById('insp-overlay').style.display = 'block'; }
function closeOverlay(id) { document.getElementById(id).style.display = 'none'; }

function previewRoom(src) { roomImg.src = src; roomImg.style.display = 'block'; roomImg.style.opacity = '0.7'; }
function resetRoom() { if (lockedRoom) { roomImg.src = lockedRoom; roomImg.style.opacity = '1'; } else if (activeRoom !== 'custom') { roomImg.style.display = 'none'; } }

function openCabinet(mode) {
  activeMode = mode;
  cab.classList.add('cabinet-visible');
  fan.classList.remove('active-fan');
  currentLevel = 0;
}

function lift(el) { document.querySelectorAll('.vintage-tabs .drawer-hardware').forEach(d => d.classList.remove('active-lift')); el.classList.add('active-lift'); }

// FIXED FAN
function setFan(icons, callbacks, labels, isInventory) {
  fan.classList.remove('active-fan', 'lvl-1', 'lvl-2', 'lvl-3');
  setTimeout(() => {
    b.forEach((blade, i) => {
      const hasIcon = icons && icons[i];
      const hasLabel = labels && labels[i];
      if(hasIcon || hasLabel) {
        blade.style.display = 'flex';
        let labelText = hasLabel ? labels[i] : "";
        let iconHTML = hasIcon ? `<img src="${icons[i]}" class="fan-icon" draggable="${isInventory}" onclick="${callbacks[i]}">` : '';
        blade.innerHTML = `<div class="blade-label" onclick="${callbacks[i]}">${labelText}</div>${iconHTML}`;
      } else { blade.style.display = 'none'; }
    });
    fan.classList.add('active-fan', 'lvl-' + currentLevel);

    // Position decor fan from top drawer if active
    if(activeMode === 'decor') {
      const topDrawer = document.querySelectorAll('#drawer-anchor .drawer-row')[0];
      const topCenter = topDrawer.offsetTop + (topDrawer.offsetHeight/2);
      fan.style.top = topCenter + "px";
    }

  }, 400);
}

function handleDrawerClick(src, el) {
  activeRoom = src; lockedRoom = src; activeEl = el; roomImg.style.opacity = '1'; currentLevel = 1; renderCurrentLevel();
}

function renderCurrentLevel() {
  if(activeRoom !== 'custom') { roomImg.src = activeRoom; roomImg.style.display = 'block'; }
  if(currentLevel === 1) {
    if(activeMode === 'decor') {
      setFan(
        ['iconrugs.png','iconlighting.png','iconart.png','iconplants.png'],
        ['openInv("rug")','openInv("lamp")','openInv("art")','openInv("plant")'],
        ['RUGS','LIGHTING','ART','PLANTS'],
        false
      );
    } else {
      setFan(
        ['iconseating.png','iconstorage.png','iconbeds.png','iconstable.png'],
        ['openSub()','openInv("storage")','','openInv("table")'],
        ['SEATING','STORAGE','BEDS','TABLES'],
        false
      );
    }
  } else if(currentLevel === 2) { openSub(); }
}

function openSub() {
  currentLevel = 2;
  setFan([],
    ['openInv("couch")','openInv("chair")','openInv("dining")','openInv("bench")','openInv("stool")'],
    ['COUCHES','CHAIRS','DINING','BENCHES','STOOLS'],
    false
  );
}

function openInv(type) {
  currentLevel = 3;
  let inv = []; let codes = [];
  if(type === "storage") { inv = ['dresser1.png','shelf1.png']; codes = ['[#S-101]','[#S-102]']; }
  else if(type === "table") { inv = ['coffeetable.png']; codes = ['[#T-201]']; }
  else if(type === "rug") { inv = ['rug1.png','rug2.png']; codes = ['[#D-301]','[#D-302]']; }
  else if(type === "couch") { inv = ['couch1.png','couch2.png']; codes = ['[#F-401]','[#F-402]']; }
  else if(type === "lamp") { inv = ['lamp1.png','lamp2.png']; codes = ['[#D-501]','[#D-502]']; }
  else { inv = [`${type}1.png`]; codes = [`[#REF-001]`]; }
  let labels = inv.map((f,i)=>f.split('.')[0].toUpperCase()+' '+(codes[i]||''));
  setFan(inv, inv.map(()=>''), labels, true);
}

function drag(ev){ ev.dataTransfer.setData("src", ev.target.src); }
function drop(ev){
  ev.preventDefault(); const src = ev.dataTransfer.getData("src"); const img = document.createElement("img");
  img.src = src; img.className="placed-item";
  const rect = document.getElementById("stage-zone").getBoundingClientRect();
  img.style.left=(ev.clientX-rect.left-100)+"px"; img.style.top=(ev.clientY-rect.top-100)+"px";
  img.onmousedown=function(e){
    let shiftX=e.clientX-img.getBoundingClientRect().left;
    let shiftY=e.clientY-img.getBoundingClientRect().top;
    function moveAt(pageX,pageY){ img.style.left=pageX-rect.left-shiftX+'px'; img.style.top=pageY-rect.top-shiftY+'px'; }
    document.addEventListener('mousemove', moveAt);
    img.onmouseup=function(){document.removeEventListener('mousemove',moveAt);}
  };
  img.ondragstart=()=>false;
  document.getElementById("stage-zone").appendChild(img);
}
</script>
</body>
</html>
